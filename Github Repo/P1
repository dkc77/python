import requests
from bs4 import BeautifulSoup
import os

# URL of the page with CSV/XLS links
url = "https://nbp.pl/statystyka-i-sprawozdawczosc/kursy/archiwum-tabela-a-csv-xls/"

# Fetch the page
response = requests.get(url)
response.raise_for_status()

# Parse HTML
soup = BeautifulSoup(response.text, "html.parser")

# Find all links to CSV files
csv_links = []
for a in soup.find_all("a", href=True):
    href = a["href"]
    if href.lower().endswith(".csv"):
        # Make sure the link is absolute
        if not href.startswith("http"):
            href = "https://nbp.pl" + href
        csv_links.append(href)

# Download CSV files
os.makedirs("nbp_csv", exist_ok=True)
for link in csv_links:
    filename = os.path.join("nbp_csv", link.split("/")[-1])
    print(f"Downloading {link} -> {filename}")
    r = requests.get(link)
    r.raise_for_status()
    with open(filename, "wb") as f:
        f.write(r.content)

print("Download complete.")